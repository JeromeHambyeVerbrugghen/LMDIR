<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Use cases and examples for <code>LMDIR</code> • LMDIR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Use cases and examples for &lt;code&gt;LMDIR&lt;/code&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LMDIR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/LMDIR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MatthewHeun/LMDIR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Use cases and examples for <code>LMDIR</code>
</h1>
                        <h4 class="author">Matthew Kuperus Heun</h4>
            
            <h4 class="date">2019-01-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MatthewHeun/LMDIR/blob/master/vignettes/LMDIR.Rmd"><code>vignettes/LMDIR.Rmd</code></a></small>
      <div class="hidden name"><code>LMDIR.Rmd</code></div>

    </div>

    
    
<!-- This script numbers equations in the html output. -->
<!-- From https://stackoverflow.com/questions/35026405/auto-number-equations-in-r-markdown-documents-in-rstudio. -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { 
      equationNumbers: { 
            autoNumber: "all",
            formatNumber: function (n) {return n}
      } 
  }
});
</script><!-- Establish some helpful LaTeX shortcuts for equations --><div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Log-mean divisia index (LMDI) decomposition analysis is an important technique for understanding causes of changes in an energy composite over time. The technique was pioneered by B.W. Ang and is described in detail in <a href="https://doi.org/10.1016/j.enpol.2003.10.010">Ang <span class="citation">(2005)</span></a>. LMDI decomposes an energy aggregate by factors and categories.</p>
<p><a href="https://doi.org/xxxx">Heun and Brockway <span class="citation">(2019)</span></a> developed a matrix representation of the LMDI mathematics that works well with the Physical Supply Use Table (PSUT) framework developed by <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>. This vignette describes and provides examples for the matrix method for LMDI decomposition analysis. This vignette is a version of Section S3 of the Supplemental Information to <a href="https://doi.org/xxxx">Heun and Brockway <span class="citation">(2019)</span></a>.</p>
</div>
<div id="description-of-the-matrix-method-for-lmdi-decomposition-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#description-of-the-matrix-method-for-lmdi-decomposition-analysis" class="anchor"></a>Description of the matrix method for LMDI decomposition analysis</h2>
<p>The LMDI approach pioneered by <a href="https://doi.org/10.1016/s0360-5442(98)00016-4">Ang et al. <span class="citation">(1998)</span></a> and described in detail by <a href="https://doi.org/10.1016/s0306-2619(03)00043-6">Liu and Ang <span class="citation">(2003)</span></a> decomposes an energy aggregate (<span class="math inline">\(V\)</span>) by factors (<span class="math inline">\(x\)</span>) that cause <span class="math inline">\(V\)</span> to change over time. (In this vignette, we adopt the notation of <a href="https://doi.org/10.1016/j.enpol.2003.10.010">Ang <span class="citation">(2005)</span></a>.)</p>
<p>Noting that at a given time every combination of energy category (<span class="math inline">\(i\)</span>) and decomposition factor (<span class="math inline">\(j\)</span>) has an associated numerical value for the decomposition factor (<span class="math inline">\(x_{ij}\)</span>), the matrix approach to LMDI decomposition analysis begins with formation of an <span class="math inline">\(\mathbf{X}\)</span> matrix for each time of interest. Rows of <span class="math inline">\(\mathbf{X}\)</span> contain energy categories (indexed by <span class="math inline">\(i\)</span>) of the aggregate (<span class="math inline">\(V\)</span>) and columns of <span class="math inline">\(\mathbf{X}\)</span> contain decomposition factors (indexed by <span class="math inline">\(j\)</span>).</p>
<p>Column vector <span class="math inline">\(\mathbf{v}\)</span> contains the value of each energy category (<span class="math inline">\(v_i\)</span>) and is formed from row products of <span class="math inline">\(\mathbf{X}\)</span>.</p>
<span class="math display">\[\begin{equation} \label{eq:v}
  v_i = \prod_j x_{ij}
\end{equation}\]</span>
<p>At any given time, the energy aggregate (<span class="math inline">\(V\)</span>) is obtained by the column sum of elements in the <span class="math inline">\(\mathbf{v}\)</span> vector</p>
<span class="math display">\[\begin{equation} \label{eq:V}
  V = \mathbf{i}^\mathrm{T} \mathbf{v} \; ,
\end{equation}\]</span>
<p>where <span class="math inline">\(\mathbf{i}\)</span> is a column vector of 1’s (an identity vector) of same size as <span class="math inline">\(\mathbf{v}\)</span>.</p>
<p>Additive (<span class="math inline">\(\Delta V\)</span>) and multiplicative (<span class="math inline">\(D\)</span>) changes in the energy aggregate (<span class="math inline">\(V\)</span>) between two adjacent times, an initial time (superscript <span class="math inline">\(0\)</span>) and a later time (superscript <span class="math inline">\(T\)</span>), are calculated by</p>
<span class="math display">\[\begin{equation} \label{eq:deltaV_def}
  \Delta V = V^T - V^0 \; ,
\end{equation}\]</span>
<p>and</p>
<span class="math display">\[\begin{equation} \label{eq:D_def}
  D = \frac{V^T}{V^0} \; .
\end{equation}\]</span>
<p>A <span class="math inline">\(\mathbf{Z}\)</span> matrix is formed for two adjacent times by</p>
<span class="math display">\[\begin{equation} \label{eq:Z_eqn_element_notation}
  Z_{ij} = \frac{v_i^T - v_i^0}{\ln \left( \frac{v_i^T}{v_i^0}\right)} 
            \ln \left( \frac{x_{ij}^T}{x_{ij}^0} \right) ,
\end{equation}\]</span>
<p>with care taken to address the zero-value problem noted by <a href="https://doi.org/10.1016/s0360-5442(98)00016-4">Ang et al. <span class="citation">(1998)</span></a> in Table 2 and discussed at length by <a href="https://doi.org/10.1016/j.enpol.2004.11.010">Wood and Lenzen <span class="citation">(2006)</span></a>.</p>
<p>Given the <span class="math inline">\(\mathbf{Z}\)</span> matrix defined by the equation for <span class="math inline">\(Z_{ij}\)</span> above, a <span class="math inline">\(\Delta \mathbf{v}\)</span> vector is calculated by column sums of <span class="math inline">\(\mathbf{Z}\)</span></p>
<span class="math display">\[\begin{equation} \label{eq:deltaV_eqn}
  \Delta \mathbf{V} = \mathbf{i}^\mathrm{T} \mathbf{Z} \; ,
\end{equation}\]</span>
<p>where entries in <span class="math inline">\(\Delta \mathbf{V}\)</span> give the additive contribution of the <span class="math inline">\(j^\mathrm{th}\)</span> decomposition factor to changes in <span class="math inline">\(V\)</span> from time <span class="math inline">\(0\)</span> to time <span class="math inline">\(T\)</span>.</p>
<p>Multiplicative decomposition is obtained with the <span class="math inline">\(\mathbf{D}\)</span> row vector calculated by</p>
<span class="math display">\[\begin{equation} \label{eq:D_eqn}
  D_j = \exp \left( \frac{\Delta V_j}{\frac{V^T - V^0}{\ln \frac{V^T}{V^0}}} \right) \; ,
\end{equation}\]</span>
<p>where entries in <span class="math inline">\(\mathbf{D}\)</span> give the multiplicative contribution of the <span class="math inline">\(j^\mathrm{th}\)</span> decomposition factor to changes in <span class="math inline">\(V\)</span> from time <span class="math inline">\(0\)</span> to time <span class="math inline">\(T\)</span>.</p>
<p>Verification can be performed by</p>
<span class="math display">\[\begin{equation} \label{eq:deltaV_check}
   \Delta \mathbf{V} \mathbf{i} \overset{?}{=} V^T - V^0 \; ,
\end{equation}\]</span>
<p>and</p>
<span class="math display">\[\begin{equation} \label{eq:D_check}
   \prod_j D_j \overset{?}{=} \frac{V^T}{V^0}\; .
\end{equation}\]</span>
<p>Cumulative changes in <span class="math inline">\(V\)</span> over many time periods can be calculated by cumulative sums of the <span class="math inline">\(\Delta \mathbf{V}\)</span> row vector for additive decomposition and by cumulative products of the <span class="math inline">\(\mathbf{D}\)</span> row vector for multiplicative decomposition.</p>
</div>
<div id="application-of-the-matrix-method-to-energy-conversion-chain-ecc-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#application-of-the-matrix-method-to-energy-conversion-chain-ecc-analysis" class="anchor"></a>Application of the matrix method to energy conversion chain (ECC) analysis</h2>
<p>An energy conversion chain (ECC) is a set of energy carriers, energy transformation devices, and energy services within spatial and temporal boundaries of interest. For the purposes of this vignette, an ECC comprises primary, final, and useful energy and exergy flowing through society.</p>
<p>Following <a href="https://doi.org/10.1016/j.apenergy.2015.05.082">Brockway et al. <span class="citation">(2015)</span></a>, one energy aggregate from an ECC is total useful exergy supplied to the economy (<span class="math inline">\(X_u\)</span>). <span class="math inline">\(X_u\)</span> is comprised of subcategories (<span class="math inline">\(sc\)</span>, Heat, Electric, Mechanical Drive (Petroleum), and Muscle Work) and subsubcategories (<span class="math inline">\(ssc\)</span>, such as KE–Fans and MD–Tractors). The decomposition factors are given in the following table.</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="89%">
</colgroup>
<thead><tr class="header">
<th align="right">factor</th>
<th align="left">description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(X_p\)</span></td>
<td align="left">Total primary exergy supplied to the economy</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\phi_{p,sc}\)</span></td>
<td align="left">Allocation ratio of primary exergy (<span class="math inline">\(p\)</span>) to subcategory (<span class="math inline">\(sc\)</span>) (Heat, Electric, Mechanical drive, Muscle work)</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(\phi_{sc,ssc}\)</span></td>
<td align="left">Allocation ratio of exergy from subcategory (<span class="math inline">\(sc)\)</span> to subsubcategory (<span class="math inline">\(ssc\)</span>) (MD - Diesel trains, Electric lights, etc.)</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\eta_{ssc}\)</span></td>
<td align="left">Primary-to-useful thermodynamic efficiency of subsubcategory (<span class="math inline">\(ssc\)</span>)</td>
</tr>
</tbody>
</table>
<p>In equation form, the energy aggregate (<span class="math inline">\(X_u\)</span>) is calculated by</p>
<span class="math display">\[\begin{equation} \label{eq:X_u_eqn}
  X_u = \sum_{ssc} X_{u,ssc} \; ,
\end{equation}\]</span>
<p>and</p>
<span class="math display">\[\begin{equation} \label{eq:X_u_i_eqn}
  X_{u,ssc} = X_{p,tot} \phi_{p,sc} \phi_{sc,ssc} \eta_{ssc}
      = X_{p,tot} \frac{X_{sc}}{X_{p,tot}} \frac{X_{ssc}}{X_{sc}} \frac{X_{u,ssc}}{X_{p,ssc}} \; .
\end{equation}\]</span>
<p>Note that <span class="math inline">\(X_{p,ssc}\)</span> is the embodied primary exergy of the useful exergy produced by the subsubcategory (<span class="math inline">\(X_{u,ssc}\)</span>).</p>
</div>
<div id="simple-example" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-example" class="anchor"></a>Simple example</h2>
<p>To demonstrate the matrix approach to LMDI decomposition analysis, we begin with a simple example that is small enough to allow replication of the results by hand calculations if desired<br>
but sufficient detail to illustrate features of the calculations.</p>
<p>A data frame of <span class="math inline">\(\mathbf{X}\)</span> matrices is the starting point for a simple example. The example has two fictitious countries (<code>AB</code> and <code>YZ</code>) and covers four years (1971–1974). Countries <code>AB</code> and <code>YZ</code> are identical for the purposes of illustration.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(LMDIR)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(matsbyname)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(matsindf)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">DF &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_simple_LMDI.html">create_simple_LMDI</a></span>()</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">DF</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;   Country Year                 X</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; 1      AB 1971 1, 4, 10, 5, 2, 3</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; 2      AB 1972  4, 5, 5, 6, 3, 4</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; 3      AB 1973  8, 5, 2, 7, 4, 5</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; 4      AB 1974 10, 6, 1, 8, 5, 6</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; 5      YZ 1971 1, 4, 10, 5, 2, 3</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; 6      YZ 1972  4, 5, 5, 6, 3, 4</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; 7      YZ 1973  8, 5, 2, 7, 4, 5</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt; 8      YZ 1974 10, 6, 1, 8, 5, 6</span></a></code></pre></div>
<p>For the remainder of these examples, only the first four rows will be shown. (Rows 5–8 for country <code>YZ</code> are the same as rows 1–4 for country <code>AB</code>.)</p>
<p>The <code>X</code> column of the data frame contains <span class="math inline">\(\mathbf{X}\)</span> matrices. The <span class="math inline">\(\mathbf{X}\)</span> matrices contain all the information about energy categories and factors. The <span class="math inline">\(\mathbf{X}\)</span> matrices are all that is needed to perform the LMDI analysis.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">DF[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]<span class="op">$</span>X</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;             factor 1 factor 2 factor 3</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; subsubcat 1        1       10        2</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; subsubcat 2        4        5        3</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;             factor 1 factor 2 factor 3</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; subsubcat 1        4        5        3</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; subsubcat 2        5        6        4</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;             factor 1 factor 2 factor 3</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; subsubcat 1        8        2        4</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; subsubcat 2        5        7        5</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt;             factor 1 factor 2 factor 3</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt; subsubcat 1       10        1        5</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt; subsubcat 2        6        8        6</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co">#&gt; [1] "factor"</span></a></code></pre></div>
<p>To see how the factors affect the aggregate over time, we can perform the LMDI decomposition analysis. But we first group by <code>Country</code> to ensure that each <code>Country</code> will be treated separately. (<code><a href="../reference/lmdi.html">lmdi()</a></code> respects grouping.)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">res &lt;-<span class="st"> </span>DF <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(Country) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/lmdi.html">lmdi</a></span>()</a></code></pre></div>
<p>The result of the call to <code><a href="../reference/lmdi.html">lmdi()</a></code> is <code>DF</code> with additional columns.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(res)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; Observations: 8</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; Variables: 13</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; $ Country    &lt;chr&gt; "AB", "AB", "AB", "AB", "YZ", "YZ", "YZ", "YZ"</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; $ Year       &lt;dbl&gt; 1971, 1972, 1973, 1974, 1971, 1972, 1973, 1974</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; $ X          &lt;list&gt; [&lt;1, 4, 10, 5, 2, 3&gt;, &lt;4, 5, 5, 6, 3, 4&gt;, &lt;8, 5, 2...</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; $ V          &lt;list&gt; [80, 180, 239, 338, 80, 180, 239, 338]</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; $ Z          &lt;list&gt; [&lt;0, 0, 0, 0, 0, 0&gt;, &lt;50.47438, 19.31569, -25.2371...</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; $ dV_agg     &lt;list&gt; [0, 100, 59, 99, 0, 100, 59, 99]</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; $ D_agg      &lt;list&gt; [1, 2.25, 1.327778, 1.414226, 1, 2.25, 1.327778, 1...</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; $ dV         &lt;list&gt; [&lt;0, 0, 0&gt;, &lt;69.790066, -9.455126, 39.665060&gt;, &lt;42...</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; $ D          &lt;list&gt; [&lt;1, 1, 1&gt;, &lt;1.7611178, 0.9261913, 1.3794101&gt;, &lt;1....</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; $ dV_agg_cum &lt;list&gt; [0, 100, 159, 258, 0, 100, 159, 258]</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; $ D_agg_cum  &lt;list&gt; [1, 2.25, 2.9875, 4.225, 1, 2.25, 2.9875, 4.225]</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; $ dV_cum     &lt;list&gt; [&lt;0, 0, 0&gt;, &lt;69.790066, -9.455126, 39.665060&gt;, &lt;11...</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; $ D_cum      &lt;list&gt; [&lt;1, 1, 1&gt;, &lt;1.7611178, 0.9261913, 1.3794101&gt;, &lt;2....</span></a></code></pre></div>
<p>Each additional column provides results of the LMDI analysis. Both additive and multiplicative results are provided.</p>
<p>The <code>V</code> column contains aggregates (<span class="math inline">\(V\)</span>), with the first year assigned a value of <code>0</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">res<span class="op">$</span>V <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>()</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1]  80 180 239 338  80 180 239 338</span></a></code></pre></div>
<p>The <code>Z</code> column contains <span class="math inline">\(\mathbf{Z}\)</span> matrices, with the first year assigned a value of <code>1</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">res[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]<span class="op">$</span>Z</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;             factor 1 factor 2 factor 3</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; subsubcat 1        0        0        0</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; subsubcat 2        0        0        0</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;             factor 1  factor 2 factor 3</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; subsubcat 1 50.47438 -25.23719 14.76281</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; subsubcat 2 19.31569  15.78206 24.90225</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;             factor 1  factor 2 factor 3</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; subsubcat 1 42.96021 -56.79031 17.83010</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; subsubcat 2  0.00000  22.47129 32.52871</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt;             factor 1  factor 2 factor 3</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; subsubcat 1 12.65498 -39.30996 12.65498</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; subsubcat 2 41.35566  30.28868 41.35566</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt; [1] "factor"</span></a></code></pre></div>
<p>Note that calculating the entries in the <span class="math inline">\(\mathbf{Z}\)</span> matrices requires evaluating 8 degenerate cases as shown in Table 2, p. 492 of <a href="https://doi.org/10.1016/s0360-5442(98)00016-4">Ang et al. <span class="citation">(1998)</span></a>. Evaluation of the 8 degenerate cases is performed by the <code><a href="../reference/Zij.html">Zij()</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">Zij</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; function(i = NULL, j = NULL, X_0 = NULL, X_T = NULL,</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;                 v_0i1 = rowprods_byname(X_0)[i, 1],</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;                 v_Ti1 = rowprods_byname(X_T)[i, 1],</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;                 X_0ij = X_0[i, j],</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;                 X_Tij = X_T[i, j]){</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;   # Check the conditions, found in Table 2, p. 492 of</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;   # B.W. Ang and F.Q. Zhang and Ki-Hong Choi, 1998,</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;   # Factorizing changes in energy and environmental indicators through decomposition,</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;   # Energy, Volume 23, Number 6, pp. 489-495.</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;   if (v_0i1 == 0 &amp; v_Ti1 &gt; 0 &amp; X_0ij == 0 &amp; X_Tij &gt; 0) {</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;     # Case 1</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;     return(v_Ti1)</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt;   } else if (v_0i1 &gt; 0 &amp; v_Ti1 == 0 &amp; X_0ij &gt; 0 &amp; X_Tij == 0) {</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt;     # Case 2</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt;     return(-v_0i1)</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt;   } else if (v_0i1 == 0 &amp; v_Ti1 &gt; 0 &amp; X_0ij &gt; 0 &amp; X_Tij &gt; 0) {</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;     # Case 3</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt;     return(0)</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt;   } else if (v_0i1 &gt; 0 &amp; v_Ti1 == 0 &amp; X_0ij &gt; 0 &amp; X_Tij &gt; 0) {</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt;     # Case 4</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt;     return(0)</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt;   } else if (v_0i1 == 0 &amp; v_Ti1 == 0 &amp; X_0ij &gt; 0 &amp; X_Tij &gt; 0) {</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt;     # Case 5</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt;     return(0)</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt;   } else if (v_0i1 == 0 &amp; v_Ti1 == 0 &amp; X_0ij == 0 &amp; X_Tij == 0) {</span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt;     # Case 6</span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt;     return(0)</span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt;   } else if (v_0i1 == 0 &amp; v_Ti1 == 0 &amp; X_0ij &gt; 0 &amp; X_Tij == 0) {</span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt;     # Case 7</span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt;     return(0)</span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"><span class="co">#&gt;   } else if (v_0i1 == 0 &amp; v_Ti1 == 0 &amp; X_0ij == 0 &amp; X_Tij &gt; 0) {</span></a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co">#&gt;     # Case 8</span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42"><span class="co">#&gt;     return(0)</span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-44" data-line-number="44"><span class="co">#&gt;   } else if (v_0i1 &gt; 0 &amp; v_Ti1 &gt; 0 &amp; X_0ij &gt; 0 &amp; X_Tij &gt; 0) {</span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="co">#&gt;     # This is the non-degenerate case</span></a>
<a class="sourceLine" id="cb7-46" data-line-number="46"><span class="co">#&gt;     return(logmean(v_Ti1, v_0i1) * log(X_Tij / X_0ij))</span></a>
<a class="sourceLine" id="cb7-47" data-line-number="47"><span class="co">#&gt;   }</span></a>
<a class="sourceLine" id="cb7-48" data-line-number="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-49" data-line-number="49"><span class="co">#&gt;   stop("Unknown conditions for v_0i1, v_Ti1, X_0ij, and X_Tij in Zij")</span></a>
<a class="sourceLine" id="cb7-50" data-line-number="50"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb7-51" data-line-number="51"><span class="co">#&gt; &lt;bytecode: 0x7fb73d88f770&gt;</span></a>
<a class="sourceLine" id="cb7-52" data-line-number="52"><span class="co">#&gt; &lt;environment: namespace:LMDIR&gt;</span></a></code></pre></div>
<p>The <code>dV_agg</code> column contains year-to-year differences in the aggregate (<span class="math inline">\(V\)</span>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">res[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]<span class="op">$</span>dV_agg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>()</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; [1]   0 100  59  99</span></a></code></pre></div>
<p>The <code>D_agg</code> column contains year-to-year ratios of the aggregate (<span class="math inline">\(V\)</span>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">res<span class="op">$</span>D_agg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>()</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; [1] 1.000000 2.250000 1.327778 1.414226 1.000000 2.250000 1.327778 1.414226</span></a></code></pre></div>
<p>The <code>dV</code> column contains <span class="math inline">\(\mathbf{\Delta V}\)</span> vectors.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">res[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]<span class="op">$</span>dV</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; factor 1         0</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; factor 2         0</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; factor 3         0</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; factor 1 69.790066</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; factor 2 -9.455126</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; factor 3 39.665060</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; factor 1  42.96021</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt; factor 2 -34.31903</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; factor 3  50.35881</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; factor 1 54.010642</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt; factor 2 -9.021285</span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt; factor 3 54.010642</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#&gt; [1] "subsubcat"</span></a></code></pre></div>
<p>The <code>D</code> column contains <span class="math inline">\(\mathbf{D}\)</span> vectors.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">res[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]<span class="op">$</span>D</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; factor 1         1</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; factor 2         1</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; factor 3         1</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; factor 1 1.7611178</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; factor 2 0.9261913</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; factor 3 1.3794101</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co">#&gt; factor 1 1.2292846</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="co">#&gt; factor 2 0.8479702</span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co">#&gt; factor 3 1.2737739</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34"><span class="co">#&gt; factor 1 1.2081402</span></a>
<a class="sourceLine" id="cb11-35" data-line-number="35"><span class="co">#&gt; factor 2 0.9689115</span></a>
<a class="sourceLine" id="cb11-36" data-line-number="36"><span class="co">#&gt; factor 3 1.2081402</span></a>
<a class="sourceLine" id="cb11-37" data-line-number="37"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb11-38" data-line-number="38"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb11-39" data-line-number="39"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb11-40" data-line-number="40"><span class="co">#&gt; [1] "subsubcat"</span></a></code></pre></div>
<p>The remaining columns have the <code>_cum</code> suffix and represent cumulative values. The <code>dV_agg_cum</code> column gives cumulative differences in the aggregate (<span class="math inline">\(V\)</span>) relative to the first time.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">res<span class="op">$</span>dV_agg_cum <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>()</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; [1]   0 100 159 258   0 100 159 258</span></a></code></pre></div>
<p>The <code>D_agg_cum</code> column gives cumulative ratios of the aggregate (<span class="math inline">\(V\)</span>) relative to the first time.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">res<span class="op">$</span>D_agg_cum <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>()</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; [1] 1.0000 2.2500 2.9875 4.2250 1.0000 2.2500 2.9875 4.2250</span></a></code></pre></div>
<p>The <code>dV_cum</code> column gives the cumulative differences in the <span class="math inline">\(\mathbf{\Delta V}\)</span> vectors relative to the first time.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">res[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]<span class="op">$</span>dV_cum</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; factor 1         0</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; factor 2         0</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; factor 3         0</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; factor 1 69.790066</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; factor 2 -9.455126</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; factor 3 39.665060</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">#&gt; factor 1 112.75028</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="co">#&gt; factor 2 -43.77415</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">#&gt; factor 3  90.02387</span></a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb14-34" data-line-number="34"><span class="co">#&gt; factor 1 166.76092</span></a>
<a class="sourceLine" id="cb14-35" data-line-number="35"><span class="co">#&gt; factor 2 -52.79544</span></a>
<a class="sourceLine" id="cb14-36" data-line-number="36"><span class="co">#&gt; factor 3 144.03451</span></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb14-38" data-line-number="38"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb14-39" data-line-number="39"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb14-40" data-line-number="40"><span class="co">#&gt; [1] "subsubcat"</span></a></code></pre></div>
<p>The <code>D_cum</code> column gives the cumulative ratios of the <span class="math inline">\(\mathbf{D}\)</span> vectors relative to the first time.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">res[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]<span class="op">$</span>D_cum</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; factor 1         1</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt; factor 2         1</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; factor 3         1</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#&gt; factor 1 1.7611178</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt; factor 2 0.9261913</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt; factor 3 1.3794101</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"><span class="co">#&gt; factor 1 2.1649150</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25"><span class="co">#&gt; factor 2 0.7853827</span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26"><span class="co">#&gt; factor 3 1.7570566</span></a>
<a class="sourceLine" id="cb15-27" data-line-number="27"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb15-29" data-line-number="29"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="co">#&gt; [1] "subsubcat"</span></a>
<a class="sourceLine" id="cb15-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb15-33" data-line-number="33"><span class="co">#&gt;          subsubcat</span></a>
<a class="sourceLine" id="cb15-34" data-line-number="34"><span class="co">#&gt; factor 1 2.6155209</span></a>
<a class="sourceLine" id="cb15-35" data-line-number="35"><span class="co">#&gt; factor 2 0.7609663</span></a>
<a class="sourceLine" id="cb15-36" data-line-number="36"><span class="co">#&gt; factor 3 2.1227708</span></a>
<a class="sourceLine" id="cb15-37" data-line-number="37"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb15-38" data-line-number="38"><span class="co">#&gt; [1] "factor"</span></a>
<a class="sourceLine" id="cb15-39" data-line-number="39"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb15-40" data-line-number="40"><span class="co">#&gt; [1] "subsubcat"</span></a></code></pre></div>
</div>
<div id="realistic-example-ghaha" class="section level2">
<h2 class="hasAnchor">
<a href="#realistic-example-ghaha" class="anchor"></a>Realistic example (Ghaha)</h2>
<p>The objective of this analysis is to discern the drivers of changes to useful exergy supplied to the Ghanaian economy over time, expressed in multiplicative form. To achieve this objective, we will perform and report results of an LMDI analysis of the Ghanaian energy conversion chain. This analysis also serves to demonstrate the use of the LMDIR package with data from a real energy conversion chain.</p>
<p>We’ll use data from <a href="https://doi.org/xxxx">Heun and Brockway <span class="citation">(2019)</span></a> for exergy flows through Ghanaian society. The data frame consists of annual <span class="math inline">\(\mathbf{X}\)</span> matrices for Ghana over the period 1971–2013. This data frame is available as <code><a href="../reference/XGH.html">LMDIR::XGH</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(XGH)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#&gt; Observations: 43</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt; Variables: 3</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt; $ Country &lt;chr&gt; "GH", "GH", "GH", "GH", "GH", "GH", "GH", "GH", "GH", ...</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; $ Year    &lt;dbl&gt; 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, ...</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt; $ X       &lt;list&gt; [&lt;5.057340e-01, 9.301474e-02, 2.415366e-02, 7.655509e...</span></a></code></pre></div>
<p>Each <span class="math inline">\(\mathbf{X}\)</span> matrix contains useful exergy subsubcategories (in rows) and factors (in columns). The format of the <span class="math inline">\(\mathbf{X}\)</span> matrices is shown below. Note that row and column ordering is provided for readability. The ordered rows show identical values of <span class="math inline">\(\phi_i\)</span> for allocation to the subcategories of Heat, Electricity, Mechanical drive (fueled by petroleum), and Muscle work (fueled by food and feed). Column order follows flows of energy and exergy through the economy, from primary stage to allocation to subcategories through allocation to subsubcategories and, finally, to a primary-to-useful efficiency for each task. All unique <span class="math inline">\(\phi_i\)</span> values sum to 1. (Specifically, 0.6225 + .0204 + 0.1314 + .2258 = 1.) Within each subsubcategory, <span class="math inline">\(\phi_{ij}\)</span> values sum to 1. (E.g., for Mechanical drive fueled by food and feed, 0.8416 + 0.1584 = 1)</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">XGH<span class="op">$</span>X[[<span class="dv">1</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/matsbyname/topics/sort_rows_cols">sort_rows_cols</a></span>(<span class="dt">roworder =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="co"># Heat categories (phi_i = 0.622)</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">                              <span class="st">"HTH.600.C - Electric heaters"</span>, <span class="st">"MTH.100.C - Charcoal stoves"</span>,</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">                              <span class="st">"MTH.100.C - Kerosene stoves"</span>, <span class="st">"MTH.100.C - LPG stoves"</span>,</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">                              <span class="st">"MTH.100.C - Wood stoves"</span>,</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">                              <span class="co"># Electricity categories (phi_i = 0.020)</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7">                              <span class="st">"KE - Fans"</span>, <span class="st">"Light - Electric lights"</span>,</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">                              <span class="st">"Light - Televisions"</span>, <span class="st">"LTH.-10.C - Refrigerators"</span>,</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">                              <span class="st">"MD - Electric motors"</span>, <span class="st">"MD - Other appliances"</span>,</a>
<a class="sourceLine" id="cb17-10" data-line-number="10">                              <span class="st">"MTH.100.C - Electric heaters"</span>, <span class="st">"MTH.200.C - Irons"</span>,</a>
<a class="sourceLine" id="cb17-11" data-line-number="11">                              <span class="st">"MTH.200.C - Electric heaters"</span>,</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">                              <span class="co"># Liquid petroleum categories (phi_i = 0.131)</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13">                              <span class="st">"MD - Boat engines"</span>, <span class="st">"MD - Diesel cars"</span>,</a>
<a class="sourceLine" id="cb17-14" data-line-number="14">                              <span class="st">"MD - Diesel trains"</span>, <span class="st">"MD - Industry static diesel engines"</span>,</a>
<a class="sourceLine" id="cb17-15" data-line-number="15">                              <span class="st">"MD - Petrol cars"</span>, <span class="st">"MD - Tractors"</span>,</a>
<a class="sourceLine" id="cb17-16" data-line-number="16">                              <span class="co"># Food and feed categories (phi_i = 0.226)</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17">                              <span class="st">"MD - Draught animals"</span>, <span class="st">"MD - Manual laborers"</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18">                              ),</a>
<a class="sourceLine" id="cb17-19" data-line-number="19">                 <span class="dt">colorder =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"EXp.ktoe"</span>, <span class="st">"phi_i"</span>, <span class="st">"phi_ij"</span>, <span class="st">"eta_ij"</span>))</a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="co">#&gt;                                     EXp.ktoe      phi_i      phi_ij</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="co">#&gt; HTH.600.C - Electric heaters        4271.648 0.62246447 0.060091437</span></a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="co">#&gt; MTH.100.C - Charcoal stoves         4271.648 0.62246447 0.206735809</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23"><span class="co">#&gt; MTH.100.C - Kerosene stoves         4271.648 0.62246447 0.035573810</span></a>
<a class="sourceLine" id="cb17-24" data-line-number="24"><span class="co">#&gt; MTH.100.C - LPG stoves              4271.648 0.62246447 0.001271220</span></a>
<a class="sourceLine" id="cb17-25" data-line-number="25"><span class="co">#&gt; MTH.100.C - Wood stoves             4271.648 0.62246447 0.696327724</span></a>
<a class="sourceLine" id="cb17-26" data-line-number="26"><span class="co">#&gt; KE - Fans                           4271.648 0.02040402 0.020633902</span></a>
<a class="sourceLine" id="cb17-27" data-line-number="27"><span class="co">#&gt; Light - Electric lights             4271.648 0.02040402 0.275135730</span></a>
<a class="sourceLine" id="cb17-28" data-line-number="28"><span class="co">#&gt; Light - Televisions                 4271.648 0.02040402 0.022884874</span></a>
<a class="sourceLine" id="cb17-29" data-line-number="29"><span class="co">#&gt; LTH.-10.C - Refrigerators           4271.648 0.02040402 0.065512803</span></a>
<a class="sourceLine" id="cb17-30" data-line-number="30"><span class="co">#&gt; MD - Electric motors                4271.648 0.02040402 0.465490738</span></a>
<a class="sourceLine" id="cb17-31" data-line-number="31"><span class="co">#&gt; MD - Other appliances               4271.648 0.02040402 0.008628723</span></a>
<a class="sourceLine" id="cb17-32" data-line-number="32"><span class="co">#&gt; MTH.100.C - Electric heaters        4271.648 0.02040402 0.088664902</span></a>
<a class="sourceLine" id="cb17-33" data-line-number="33"><span class="co">#&gt; MTH.200.C - Irons                   4271.648 0.02040402 0.009191466</span></a>
<a class="sourceLine" id="cb17-34" data-line-number="34"><span class="co">#&gt; MTH.200.C - Electric heaters        4271.648 0.02040402 0.043856863</span></a>
<a class="sourceLine" id="cb17-35" data-line-number="35"><span class="co">#&gt; MD - Boat engines                   4271.648 0.13135948 0.022632537</span></a>
<a class="sourceLine" id="cb17-36" data-line-number="36"><span class="co">#&gt; MD - Diesel cars                    4271.648 0.13135948 0.238462628</span></a>
<a class="sourceLine" id="cb17-37" data-line-number="37"><span class="co">#&gt; MD - Diesel trains                  4271.648 0.13135948 0.028636504</span></a>
<a class="sourceLine" id="cb17-38" data-line-number="38"><span class="co">#&gt; MD - Industry static diesel engines 4271.648 0.13135948 0.248772936</span></a>
<a class="sourceLine" id="cb17-39" data-line-number="39"><span class="co">#&gt; MD - Petrol cars                    4271.648 0.13135948 0.405605717</span></a>
<a class="sourceLine" id="cb17-40" data-line-number="40"><span class="co">#&gt; MD - Tractors                       4271.648 0.13135948 0.055889678</span></a>
<a class="sourceLine" id="cb17-41" data-line-number="41"><span class="co">#&gt; MD - Draught animals                4271.648 0.22577203 0.841575126</span></a>
<a class="sourceLine" id="cb17-42" data-line-number="42"><span class="co">#&gt; MD - Manual laborers                4271.648 0.22577203 0.158424874</span></a>
<a class="sourceLine" id="cb17-43" data-line-number="43"><span class="co">#&gt;                                           eta_ij</span></a>
<a class="sourceLine" id="cb17-44" data-line-number="44"><span class="co">#&gt; HTH.600.C - Electric heaters        0.5057340169</span></a>
<a class="sourceLine" id="cb17-45" data-line-number="45"><span class="co">#&gt; MTH.100.C - Charcoal stoves         0.0078319796</span></a>
<a class="sourceLine" id="cb17-46" data-line-number="46"><span class="co">#&gt; MTH.100.C - Kerosene stoves         0.0624719027</span></a>
<a class="sourceLine" id="cb17-47" data-line-number="47"><span class="co">#&gt; MTH.100.C - LPG stoves              0.0802750826</span></a>
<a class="sourceLine" id="cb17-48" data-line-number="48"><span class="co">#&gt; MTH.100.C - Wood stoves             0.0244685375</span></a>
<a class="sourceLine" id="cb17-49" data-line-number="49"><span class="co">#&gt; KE - Fans                           0.0930147381</span></a>
<a class="sourceLine" id="cb17-50" data-line-number="50"><span class="co">#&gt; Light - Electric lights             0.0241536613</span></a>
<a class="sourceLine" id="cb17-51" data-line-number="51"><span class="co">#&gt; Light - Televisions                 0.0007655509</span></a>
<a class="sourceLine" id="cb17-52" data-line-number="52"><span class="co">#&gt; LTH.-10.C - Refrigerators           0.0267456265</span></a>
<a class="sourceLine" id="cb17-53" data-line-number="53"><span class="co">#&gt; MD - Electric motors                0.6734879134</span></a>
<a class="sourceLine" id="cb17-54" data-line-number="54"><span class="co">#&gt; MD - Other appliances               0.6734879134</span></a>
<a class="sourceLine" id="cb17-55" data-line-number="55"><span class="co">#&gt; MTH.100.C - Electric heaters        0.1543499029</span></a>
<a class="sourceLine" id="cb17-56" data-line-number="56"><span class="co">#&gt; MTH.200.C - Irons                   0.3541669371</span></a>
<a class="sourceLine" id="cb17-57" data-line-number="57"><span class="co">#&gt; MTH.200.C - Electric heaters        0.1707212270</span></a>
<a class="sourceLine" id="cb17-58" data-line-number="58"><span class="co">#&gt; MD - Boat engines                   0.1150512500</span></a>
<a class="sourceLine" id="cb17-59" data-line-number="59"><span class="co">#&gt; MD - Diesel cars                    0.1038333444</span></a>
<a class="sourceLine" id="cb17-60" data-line-number="60"><span class="co">#&gt; MD - Diesel trains                  0.1136618193</span></a>
<a class="sourceLine" id="cb17-61" data-line-number="61"><span class="co">#&gt; MD - Industry static diesel engines 0.2283586361</span></a>
<a class="sourceLine" id="cb17-62" data-line-number="62"><span class="co">#&gt; MD - Petrol cars                    0.1397163174</span></a>
<a class="sourceLine" id="cb17-63" data-line-number="63"><span class="co">#&gt; MD - Tractors                       0.0519166722</span></a>
<a class="sourceLine" id="cb17-64" data-line-number="64"><span class="co">#&gt; MD - Draught animals                0.0070815972</span></a>
<a class="sourceLine" id="cb17-65" data-line-number="65"><span class="co">#&gt; MD - Manual laborers                0.0219339289</span></a>
<a class="sourceLine" id="cb17-66" data-line-number="66"><span class="co">#&gt; attr(,"rowtype")</span></a>
<a class="sourceLine" id="cb17-67" data-line-number="67"><span class="co">#&gt; [1] "category"</span></a>
<a class="sourceLine" id="cb17-68" data-line-number="68"><span class="co">#&gt; attr(,"coltype")</span></a>
<a class="sourceLine" id="cb17-69" data-line-number="69"><span class="co">#&gt; [1] "factor"</span></a></code></pre></div>
<p>To perform LMDI analysis, we use the <code><a href="../reference/lmdi.html">lmdi()</a></code> function after grouping on metadata variables (in this case, only <code>Country</code>).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">GHlmdi &lt;-<span class="st"> </span>XGH <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(Country) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/lmdi.html">lmdi</a></span>()</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(GHlmdi)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt; Observations: 43</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; Variables: 13</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt; $ Country    &lt;chr&gt; "GH", "GH", "GH", "GH", "GH", "GH", "GH", "GH", "GH...</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt; $ Year       &lt;dbl&gt; 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 197...</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; $ X          &lt;list&gt; [&lt;5.057340e-01, 9.301474e-02, 2.415366e-02, 7.6555...</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; $ V          &lt;list&gt; [259.04, 281.4059, 309.6553, 318.3589, 319.1577, 3...</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt; $ Z          &lt;list&gt; [&lt;0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; $ dV_agg     &lt;list&gt; [0, 22.36586, 28.24945, 8.703568, 0.7987694, 10.09...</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; $ D_agg      &lt;list&gt; [1, 1.086341, 1.100387, 1.028107, 1.002509, 1.0316...</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#&gt; $ dV         &lt;list&gt; [&lt;0, 0, 0, 0&gt;, &lt;-0.3342389, 12.7696838, 2.6389494,...</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; $ D          &lt;list&gt; [&lt;1, 1, 1, 1&gt;, &lt;0.9987632, 1.0484188, 1.0098193, 1...</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">#&gt; $ dV_agg_cum &lt;list&gt; [0, 22.36586, 50.61531, 59.31888, 60.11765, 70.215...</span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co">#&gt; $ D_agg_cum  &lt;list&gt; [1, 1.086341, 1.195396, 1.228995, 1.232079, 1.2710...</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18"><span class="co">#&gt; $ dV_cum     &lt;list&gt; [&lt;0, 0, 0, 0&gt;, &lt;-0.3342389, 12.7696838, 2.6389494,...</span></a>
<a class="sourceLine" id="cb18-19" data-line-number="19"><span class="co">#&gt; $ D_cum      &lt;list&gt; [&lt;1, 1, 1, 1&gt;, &lt;0.9987632, 1.0484188, 1.0098193, 1...</span></a></code></pre></div>
<p>The <code>GHlmdi</code> object contains everything needed to graph the results. But first, we need to expand the data from matrices to tidy format and select the desired columns. The focus here is on the ratioed aggregate (<code>D_agg_cum</code>) and disaggregate (<code>D_cum</code>) factors that affect changes in useful exergy delivered to the economy.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">GHlmdi_tidy &lt;-<span class="st"> </span>GHlmdi <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(Country, Year, D_agg_cum, D_cum) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="dt">key =</span> matnames, <span class="dt">value =</span> matvals, <span class="op">-</span>Country, <span class="op">-</span>Year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/matsindf/topics/expand_to_tidy">expand_to_tidy</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>colnames, <span class="op">-</span>rowtypes, <span class="op">-</span>coltypes)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(GHlmdi_tidy, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; # A tibble: 10 x 5</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt;    Country  Year matnames  rownames matvals</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt;  1 GH       1971 D_agg_cum &lt;NA&gt;       1    </span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">#&gt;  2 GH       1971 D_cum     eta_ij     1    </span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">#&gt;  3 GH       1971 D_cum     EXp.ktoe   1    </span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="co">#&gt;  4 GH       1971 D_cum     phi_i      1    </span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="co">#&gt;  5 GH       1971 D_cum     phi_ij     1    </span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="co">#&gt;  6 GH       1972 D_agg_cum &lt;NA&gt;       1.09 </span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="co">#&gt;  7 GH       1972 D_cum     eta_ij     0.999</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="co">#&gt;  8 GH       1972 D_cum     EXp.ktoe   1.05 </span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"><span class="co">#&gt;  9 GH       1972 D_cum     phi_i      1.01 </span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="co">#&gt; 10 GH       1972 D_cum     phi_ij     1.03</span></a></code></pre></div>
<p>Next, we map the values of <code>varname</code> and <code>rowname</code> to variable names appropriate for graphing. We also set the levels of the Factors, and therefore the order they will appear in the legend of the graph. We choose an order that mimics the vertical position of the data in the graph.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">GHlmdi_forgraphing &lt;-<span class="st"> </span>GHlmdi_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">    <span class="dt">Factor =</span> <span class="kw"><a href="http://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">      matnames <span class="op">==</span><span class="st"> "D_agg_cum"</span> <span class="op">~</span><span class="st"> "D_tot"</span>, </a>
<a class="sourceLine" id="cb20-5" data-line-number="5">      rownames <span class="op">==</span><span class="st"> "EXp.ktoe"</span> <span class="op">~</span><span class="st"> "D_ex"</span>,</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">      rownames <span class="op">==</span><span class="st"> "eta_ij"</span> <span class="op">~</span><span class="st"> "D_eff"</span>, </a>
<a class="sourceLine" id="cb20-7" data-line-number="7">      rownames <span class="op">==</span><span class="st"> "phi_i"</span>  <span class="op">~</span><span class="st"> "D_str"</span>, </a>
<a class="sourceLine" id="cb20-8" data-line-number="8">      rownames <span class="op">==</span><span class="st"> "phi_ij"</span> <span class="op">~</span><span class="st"> "D_dil"</span> </a>
<a class="sourceLine" id="cb20-9" data-line-number="9">    ), </a>
<a class="sourceLine" id="cb20-10" data-line-number="10">    <span class="dt">Factor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(Factor, <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"D_tot"</span>, <span class="st">"D_ex"</span>, <span class="st">"D_str"</span>, <span class="st">"D_eff"</span>, <span class="st">"D_dil"</span>))</a>
<a class="sourceLine" id="cb20-11" data-line-number="11">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">rename</a></span>(</a>
<a class="sourceLine" id="cb20-13" data-line-number="13">    <span class="dt">value =</span> matvals</a>
<a class="sourceLine" id="cb20-14" data-line-number="14">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>rownames, <span class="op">-</span>matnames) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(Country, Factor)</a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(GHlmdi_forgraphing, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt; # A tibble: 10 x 4</span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt; # Groups:   Country, Factor [5]</span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt;    Country  Year value Factor</span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; </span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="co">#&gt;  1 GH       1971 1     D_tot </span></a>
<a class="sourceLine" id="cb20-23" data-line-number="23"><span class="co">#&gt;  2 GH       1971 1     D_eff </span></a>
<a class="sourceLine" id="cb20-24" data-line-number="24"><span class="co">#&gt;  3 GH       1971 1     D_ex  </span></a>
<a class="sourceLine" id="cb20-25" data-line-number="25"><span class="co">#&gt;  4 GH       1971 1     D_str </span></a>
<a class="sourceLine" id="cb20-26" data-line-number="26"><span class="co">#&gt;  5 GH       1971 1     D_dil </span></a>
<a class="sourceLine" id="cb20-27" data-line-number="27"><span class="co">#&gt;  6 GH       1972 1.09  D_tot </span></a>
<a class="sourceLine" id="cb20-28" data-line-number="28"><span class="co">#&gt;  7 GH       1972 0.999 D_eff </span></a>
<a class="sourceLine" id="cb20-29" data-line-number="29"><span class="co">#&gt;  8 GH       1972 1.05  D_ex  </span></a>
<a class="sourceLine" id="cb20-30" data-line-number="30"><span class="co">#&gt;  9 GH       1972 1.01  D_str </span></a>
<a class="sourceLine" id="cb20-31" data-line-number="31"><span class="co">#&gt; 10 GH       1972 1.03  D_dil</span></a></code></pre></div>
<p>Finally, we create a graph showing both the total changes and the factors that comprise the total change.</p>
<table class="table">
<colgroup>
<col width="9%">
<col width="14%">
<col width="76%">
</colgroup>
<thead><tr class="header">
<th align="right">graph variable</th>
<th align="center">factor</th>
<th align="left">description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">D<sub>tot</sub>
</td>
<td align="center"></td>
<td align="left">Total change in useful exergy</td>
</tr>
<tr class="even">
<td align="right">D<sub>ex</sub>
</td>
<td align="center"><span class="math inline">\(X_p\)</span></td>
<td align="left">Primary exergy supplied to the economy</td>
</tr>
<tr class="odd">
<td align="right">D<sub>str</sub>
</td>
<td align="center"><span class="math inline">\(\phi_{p,sc}\)</span></td>
<td align="left">Allocation of primary exergy (<span class="math inline">\(p\)</span>) to subcategory (<span class="math inline">\(sc\)</span>) (Heat, Electric, Mechanical drive, Muscle work) or main class structural change</td>
</tr>
<tr class="even">
<td align="right">D<sub>eff</sub>
</td>
<td align="center"><span class="math inline">\(\eta_{ssc}\)</span></td>
<td align="left">Primary-to-useful thermodynamic efficiency of subsubcategory (<span class="math inline">\(ssc\)</span>)</td>
</tr>
<tr class="odd">
<td align="right">D<sub>dil</sub>
</td>
<td align="center"><span class="math inline">\(\phi_{sc,ssc}\)</span></td>
<td align="left">Allocation ratio of exergy from subcategory (<span class="math inline">\(sc)\)</span> to subsubcategory (<span class="math inline">\(ssc\)</span>) (MD - Diesel trains, Electric lights, etc.) or subclass structural change</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">GHlmdi_forgraphing <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">mapping =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> value, <span class="dt">linetype =</span> Factor)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">"gray50"</span>, <span class="dt">size =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">"Cumulative changes relative to 1971 [-]"</span>, <span class="dt">linetype =</span> <span class="ot">NULL</span>, <span class="dt">colour =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_linetype_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"D_tot"</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">"D_ex"</span> =<span class="st"> </span><span class="dv">5</span>, <span class="st">"D_str"</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">"D_dil"</span> =<span class="st"> </span><span class="dv">6</span>, <span class="st">"D_eff"</span> =<span class="st"> </span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">                        <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"D_tot"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(D[tot]), </a>
<a class="sourceLine" id="cb21-8" data-line-number="8">                                   <span class="st">"D_ex"</span>  =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(D[ex]), </a>
<a class="sourceLine" id="cb21-9" data-line-number="9">                                   <span class="st">"D_str"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(D[str]), </a>
<a class="sourceLine" id="cb21-10" data-line-number="10">                                   <span class="st">"D_dil"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(D[dil]), </a>
<a class="sourceLine" id="cb21-11" data-line-number="11">                                   <span class="st">"D_eff"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(D[eff]))</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">  )</a></code></pre></div>
<p><img src="LMDIR_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>Note that the graph above is the same as Figure 7 of <a href="https://doi.org/xxxx">Heun and Brockway <span class="citation">(2019)</span></a>.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>The <code>LMDIR</code> package provides a convenient and powerful capability for log-mean divisia index analysis of energy conversion chains.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Ang:2005">
<p>Ang, B.W. 2005. “The LMDI Approach to Decomposition Analysis: A Practical Guide.” <em>Energy Policy</em> 33:867–71. <a href="https://doi.org/10.1016/j.enpol.2003.10.010" class="uri">https://doi.org/10.1016/j.enpol.2003.10.010</a>.</p>
</div>
<div id="ref-Ang:1998">
<p>Ang, B.W., F.Q. Zhang, and Ki-Hong Choi. 1998. “Factorizing Changes in Energy and Environmental Indicators Through Decomposition.” <em>Energy</em> 23 (6):489–95. <a href="https://doi.org/10.1016/s0360-5442(98)00016-4" class="uri">https://doi.org/10.1016/s0360-5442(98)00016-4</a>.</p>
</div>
<div id="ref-Brockway:2015aa">
<p>Brockway, Paul E., Julia K. Steinberger, John R. Barrett, and Timothy J. Foxon. 2015. “Understanding China’s Past and Future Energy Demand: An Exergy Efficiency and Decomposition Analysis.” <em>Applied Energy</em> 155:892–903. <a href="https://doi.org/10.1016/j.apenergy.2015.05.082" class="uri">https://doi.org/10.1016/j.apenergy.2015.05.082</a>.</p>
</div>
<div id="ref-Heun:2019">
<p>Heun, Matthew Kuperus, and Paul E. Brockway. 2019. “Meeting 2030 Primary Energy and Economic Growth Goals: Mission Impossible?” <em>Applied Energy</em> xxx (February):xxxx–xxxx. <a href="https://doi.org/10.1016/j.apenergy.2019.xx.xxx" class="uri">https://doi.org/10.1016/j.apenergy.2019.xx.xxx</a>.</p>
</div>
<div id="ref-Heun:2018">
<p>Heun, Matthew Kuperus, Anne Owen, and Paul E. Brockway. 2018. “A Physical Supply-Use Table Framework for Energy Analysis on the Energy Conversion Chain.” <em>Applied Energy</em> 226 (September):1134–62. <a href="https://doi.org/10.1016/j.apenergy.2018.05.109" class="uri">https://doi.org/10.1016/j.apenergy.2018.05.109</a>.</p>
</div>
<div id="ref-Liu:2003">
<p>Liu, F. L., and B. W. Ang. 2003. “Eight Methods for Decomposing the Aggregate Energy-Intensity of Industry.” <em>Applied Energy</em> 76 (1-3):15–23. <a href="https://doi.org/10.1016/s0306-2619(03)00043-6" class="uri">https://doi.org/10.1016/s0306-2619(03)00043-6</a>.</p>
</div>
<div id="ref-Wood:2006">
<p>Wood, Richard, and Manfred Lenzen. 2006. “Zero-Value Problems of the Logarithmic Mean Divisia Index Decomposition Method.” <em>Energy Policy</em> 34 (12):1326–31. <a href="https://doi.org/10.1016/j.enpol.2004.11.010" class="uri">https://doi.org/10.1016/j.enpol.2004.11.010</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#description-of-the-matrix-method-for-lmdi-decomposition-analysis">Description of the matrix method for LMDI decomposition analysis</a></li>
      <li><a href="#application-of-the-matrix-method-to-energy-conversion-chain-ecc-analysis">Application of the matrix method to energy conversion chain (ECC) analysis</a></li>
      <li><a href="#simple-example">Simple example</a></li>
      <li><a href="#realistic-example-ghaha">Realistic example (Ghaha)</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Matthew Heun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
